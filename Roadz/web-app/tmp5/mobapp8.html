<html>
<head>
	<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no"/>
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<title>Mobile App</title>
	<link rel="stylesheet" type="text/css" href="../dojo-1.7.1/dojox/mobile/themes/iphone/base.css">
	<link rel="stylesheet" type="text/css" href="../dojo-1.7.1/dojox/mobile/themes/iphone/TabBar.css">
<!-- 	<script src="http://ajax.googleapis.com/ajax/libs/dojo/1.7.2/dojo/dojo.js" djConfig="parseOnLoad: true, async: true, mblAlwaysHideAddressBar: true"></script> -->
		<script type="text/javascript">
			
			var dojoConfig = (function(){
				var base = location.href.split("/");
				base.pop();
				base = base.join("/");
				
				return {
					async: true,
					isDebug: true,
					packages: [{
						name: "tweetview",
						location: base + "/../js/tweetview"
					}]
				};
			})();
			
		</script>
    <script type="text/javascript" src="../dojo-1.7.1/dojo/dojo.js"></script>
<!-- 	<script type="text/javascript" src="src.js"></script> -->
<script type="text/javascript">
require([
     	"dojox/mobile/parser",
     	"dojox/mobile",
     	"dojox/mobile/ScrollableView",
//     	"dojox/layout/FloatingPane",
//     	"dojox/mobile/ToolbarButton",
//      	"dojox/mobile/TabBar",
//      	"dojox/mobile/TextBox",
//     	"dojox/cometd",
//     	"dojox/cometd/timestamp",
//     	"dojox/cometd/ack",
//     	"dojox/cometd/reload",
//      	"dojox/mobile/compat"
     ]);
</script>
		<script>
			
			// Require the xhr module
			require(["dojo/_base/xhr", "dojo/on", "dojo/dom", "dojo/json", "dojo/domReady!"],
				function(xhr, on, dom, json) {
					
					// Get the content node
					var contentNode = dom.byId("contentNode");
					
					// Using xhr.get, as no information is being sent -- only requesting
					function getJSON() {
						xhr.get({
							// The URL of the request
							url: "http://localhost:8080/Roadz/user/friendsjson?username=maurice",
							// Handle as JSON Data
							handleAs: "json",
							// The success callback with result from server
							load: function(newContent) {
								// Update with content
								var friends = newContent.friendship;
								contentNode.style.display = "";
								contentNode.innerHTML = "<strong>JSON loaded from server:</strong><br /><br />";
								for (var i = friends.length - 1; i >= 0; i--) {
									contentNode.innerHTML += friends[i].friend.username + "<br>"
								};
								contentNode.innerHTML += "<br /><br /><strong>Look at the JSON data in the console as well!</strong>";
								// Log to console
								console.info("JSON loaded from server:  ", newContent);
							},
							// The error handler
							error: function() {
								// Do nothing -- keep old content there
							}
						});
					}
					
					// Connect the button click
					on(dom.byId("getJson"), "click", getJSON);
					
			});
		</script>
		<script>
		(function(){
			
			require(["dojox/mobile/parser", "dojox/mobile/TabBar", "tweetview/TweetView", "tweetview/SettingsView", "dojox/mobile/deviceTheme", "dojo/dom-attr", "dojo/_base/array", "dojox/mobile", "dojo/domReady!"], function(mobileParser, TabBar, TweetView, SettingsView, dm, domAttr, baseArray) {
				// If Android....
				if(dm.currentTheme == "android") {
					var imagePath = "../js/tweetview/resources/images/";
					// Update image path on bottom tabbar
					TweetView.prototype.iconLoading = imagePath + "androidLoading.gif";
					// Add a new "iconLoading" attribute to the TweetView instances
					//domAttr.set(document.getElementById("tabBar"), "iconBase", imagePath + "iconStripAndroid.png");
				}
				// Parse the page!
				mobileParser.parse();
			});
			
			// Set accounts for tweetview directly on the namespace
			tweetview = {
				ACCOUNTS: {
					dojo: { enabled: true },
					sitepen: { enabled: true }/*,
					someaccounthatdoesntexist: { enabled: true }*/
				}
			};
			
		})();
		</script>

</head>
<body style="visibility:hidden;" >
		<h1 dojoType="dojox.mobile.Heading" fixed="top"
			label="Application Header Bar" back="Back" moveTo="back">
			<div dojoType="dojox.mobile.ToolBarButton" label="Edit"
				class="mblColorBlue" style="width: 25px; float: right;"></div>
		</h1>
		<!--
		<div id="view1" dojoType="dojox.mobile.ScrollableView" threshold="10000000">
		<div id="tweets" data-dojo-type="tweetview.TweetView" data-dojo-props="selected: true">
		-->
		<div id="tweets" data-dojo-type="tweetview.TweetView" data-dojo-props="selected: true">

					<h1>Demo: Fetch JSON Data</h1>

		<button id="getJson">Get JSON</button>
		<br /><br />

		<pre id="contentNode" style="display:none;"></pre>
</div>
		<h1 dojoType="dojox.mobile.Heading" fixed="bottom">Application Footer Bar</h1>

</body>
</html>