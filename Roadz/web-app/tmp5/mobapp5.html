<html>
<head>
	<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no"/>
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<title>Mobile App</title>
	<link rel="stylesheet" type="text/css" href="../dojo-1.7.1/dojox/mobile/themes/iphone/base.css">
	<link rel="stylesheet" type="text/css" href="../dojo-1.7.1/dojox/mobile/themes/iphone/TabBar.css">
<!-- 	<script src="http://ajax.googleapis.com/ajax/libs/dojo/1.7.2/dojo/dojo.js" djConfig="parseOnLoad: true, async: true, mblAlwaysHideAddressBar: true"></script> -->
    <script type="text/javascript" src="../dojo-1.7.1/dojo/dojo.js" djConfig="parseOnLoad: true, async: false, mblAlwaysHideAddressBar: true"></script>
<!-- 	<script type="text/javascript" src="src.js"></script> -->
<script type="text/javascript">
require([
     	"dojox/mobile/parser",
     	"dojox/mobile",
     	"dojox/mobile/ScrollableView",
//     	"dojox/layout/FloatingPane",
//     	"dojox/mobile/ToolbarButton",
//      	"dojox/mobile/TabBar",
//      	"dojox/mobile/TextBox",
//     	"dojox/cometd",
//     	"dojox/cometd/timestamp",
//     	"dojox/cometd/ack",
//     	"dojox/cometd/reload",
//      	"dojox/mobile/compat"
     ]);
</script>
		<script>
			
			// Require the xhr module
			require(["dojo/io/script", "dojo/on", "dojo/dom", "dojo/_base/array", "dojo/domReady!"],
				function(script, on, dom, arrayUtil) {
					
					// Connect the button
					on(dom.byId("getJson"), "click", function() {
						// Output message to DOM
						var tweetsHolder = dom.byId("tweetsHolder");
						// Use the get method
						script.get({
							// The URL to get JSON from Twitter
							url: "http://search.twitter.com/search.json",
							// The callback paramater
							callbackParamName: "callback", // Twitter requires "callback"
							// The content to send
							content: {
								q: "@dojo" // Searching for tweets about Dojo
							},
							// The success callback
							load: function(tweetsJson) {  // Twitter sent us information!
								// Log the result to console for inspection
								console.info("Twitter returned: ",tweetsJson);
	
								// Output the tweets to a DOM element
								// Or output a "no tweets" message
								var message = "";
	
								// If there were tweets returned...
								if(tweetsJson.results && tweetsJson.results.length) {
									// Start the list
									message += "<ul>";
									// For every tweet returned
									arrayUtil.forEach(tweetsJson.results,function(tweet) {
										message += "<li>" + tweet.from_user + " said: " + tweet.text + "</li>";
									});
									//End the list
									message += "</ul>";
								}
								else { // Output "no tweets" message
									message = "No tweets about Dojo were available.";
								}
								// Output message to DOM
								tweetsHolder.innerHTML = message;
							},
							// Ooops!  Error!
							error: function() {
								tweetsHolder.innerHTML = "Error!  Tweets could not be received.";
							}
						});
					});
					
			});
		</script>

</head>
<body style="visibility:hidden;" >
		<h1 dojoType="dojox.mobile.Heading" fixed="top"
			label="Application Header Bar" back="Back" moveTo="back">
			<div dojoType="dojox.mobile.ToolBarButton" label="Edit"
				class="mblColorBlue" style="width: 25px; float: right;"></div>
		</h1>
		<div id="view1" dojoType="dojox.mobile.ScrollableView">
			<h1>Demo: JSONP and dojo/io/script</h1>

			<button id="getJson">Get Tweets from Twitter</button>
			<br /><br />

			<div id="tweetsHolder"></div>

		</div>
		<h1 dojoType="dojox.mobile.Heading" fixed="bottom">Application Footer Bar</h1>

</body>
</html>